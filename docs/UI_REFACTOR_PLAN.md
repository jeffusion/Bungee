# Bungee UI æ¨¡å—é‡æ„ä»»åŠ¡è§„åˆ’

## é¡¹ç›®æ¦‚è¿°

å¯¹ Bungee åå‘ä»£ç†é¡¹ç›®çš„ UI æ¨¡å—è¿›è¡Œé‡æ„ï¼Œä¸»è¦ç›®æ ‡æ˜¯å®ç°é…ç½®çš„å¯è§†åŒ–å’ŒåŠ¨æ€ä¿®æ”¹ã€‚

**æŠ€æœ¯æ ˆï¼š**

- Svelte 4 + Vite 6
- TailwindCSS + DaisyUI
- svelte-spa-router (å®¢æˆ·ç«¯è·¯ç”±)
- Bun runtime (åç«¯)

---

## Phase 1: æ ¸å¿ƒé…ç½®ç¼–è¾‘ âœ… å·²å®Œæˆ

### ç›®æ ‡

å®ç°è·¯ç”±ç®¡ç†çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬ CRUD æ“ä½œã€ä¸Šæ¸¸é…ç½®ã€Headers/Body ä¿®æ”¹ç­‰ã€‚

### å·²å®ŒæˆåŠŸèƒ½

#### 1. åŸºç¡€æ¶æ„ âœ…

- [x] çŠ¶æ€ç®¡ç† Store (`packages/ui/src/lib/stores/`)
  - `config.ts` - é…ç½®çŠ¶æ€ç®¡ç†
  - `stats.ts` - ç»Ÿè®¡æ•°æ®ç®¡ç†
- [x] API å°è£… (`packages/ui/src/lib/api/`)
  - `client.ts` - HTTP å®¢æˆ·ç«¯
  - `routes.ts` - è·¯ç”± CRUD API
  - `config.ts` - é…ç½® API
  - `stats.ts` - ç»Ÿè®¡ API
  - `system.ts` - ç³»ç»Ÿ API
- [x] ç±»å‹å®šä¹‰ (`packages/ui/src/lib/types.ts`)

#### 2. éªŒè¯é€»è¾‘ âœ…

- [x] è·¯ç”±éªŒè¯å™¨ (`validation/route-validator.ts`)
  - è·¯å¾„éªŒè¯
  - Upstream éªŒè¯
  - è¡¨è¾¾å¼éªŒè¯
- [x] Upstream éªŒè¯å™¨ (`validation/upstream-validator.ts`)

#### 3. UI ç»„ä»¶ âœ…

- [x] `HeadersEditor.svelte` - Headers ä¿®æ”¹ç¼–è¾‘å™¨
  - æ”¯æŒ add/remove/replace/default æ“ä½œ
  - å¯æŠ˜å çš„åˆ†ç»„ç•Œé¢
- [x] `BodyEditor.svelte` - Body ä¿®æ”¹ç¼–è¾‘å™¨
  - æ”¯æŒ add/remove/replace/default æ“ä½œ
  - JSON æ ¼å¼åŒ–æ˜¾ç¤º
- [x] `UpstreamForm.svelte` - Upstream é…ç½®è¡¨å•
  - Target URLã€Weightã€Priority
  - Transformer é€‰æ‹©
  - Headers/Body åµŒå¥—ç¼–è¾‘
- [x] `RouteCard.svelte` - è·¯ç”±å¡ç‰‡å±•ç¤º
  - æ˜¾ç¤ºè·¯ç”±è¯¦æƒ…
  - å¥åº·çŠ¶æ€æŒ‡ç¤º
  - å¿«æ·æ“ä½œæŒ‰é’®

#### 4. é¡µé¢å®ç° âœ…

- [x] `routes/Dashboard.svelte` - ä»ªè¡¨ç›˜
  - å®æ—¶ç»Ÿè®¡æ•°æ®ï¼ˆæ€»è¯·æ±‚æ•°ã€QPSã€æˆåŠŸç‡ã€å¹³å‡å“åº”æ—¶é—´ï¼‰
  - 3 ç§’è‡ªåŠ¨åˆ·æ–°
- [x] `routes/RoutesIndex.svelte` - è·¯ç”±åˆ—è¡¨
  - æœç´¢/è¿‡æ»¤åŠŸèƒ½
  - è·¯ç”±å¡ç‰‡å±•ç¤º
  - æ–°å»º/ç¼–è¾‘/åˆ é™¤/å¤åˆ¶æ“ä½œ
- [x] `routes/RouteEditor.svelte` - è·¯ç”±ç¼–è¾‘å™¨
  - å®Œæ•´çš„è·¯ç”±é…ç½®è¡¨å•
  - å®æ—¶éªŒè¯
  - Path Rewrite æ”¯æŒ
  - Failover é…ç½®
  - Health Check é…ç½®
- [x] `routes/Configuration.svelte` - é…ç½®é¡µé¢ï¼ˆç®€åŒ–ç‰ˆï¼‰
- [x] `routes/NotFound.svelte` - 404 é¡µé¢

#### 5. è·¯ç”±é…ç½® âœ…

- [x] App.svelte - ä¸»åº”ç”¨æ¡†æ¶
  - å¯¼èˆªæ 
  - æ‰‹åŠ¨è·¯ç”±å®ç°ï¼ˆæ›¿ä»£ svelte-spa-router çš„ Router ç»„ä»¶ï¼‰
  - è·¯ç”±æ¡ä»¶æ¸²æŸ“

### å·²è§£å†³çš„æŠ€æœ¯é—®é¢˜

#### é—®é¢˜ 1: onMount ç”Ÿå‘½å‘¨æœŸé’©å­ä¸å·¥ä½œ âœ…

**åŸå› ï¼š** Vite çš„æ¨¡å—è§£æé…ç½®ç¼ºå°‘ `browser` æ¡ä»¶ï¼Œå¯¼è‡´ Svelte çš„æµè§ˆå™¨ç‰ˆæœ¬ä»£ç æœªè¢«æ­£ç¡®åŠ è½½

**è§£å†³æ–¹æ¡ˆï¼š** (`packages/ui/vite.config.ts`)

```typescript
resolve: {
  conditions: ['browser', 'module', 'import'],
},
optimizeDeps: {
  exclude: ['svelte-spa-router']
}
```

#### é—®é¢˜ 2: API è·¯å¾„é‡å¤ âœ…

**åŸå› ï¼š** `routes.ts` ä¸­é”™è¯¯ä½¿ç”¨äº† `/api/config`ï¼Œä¸ `API_BASE = '/__ui/api'` æ‹¼æ¥åå˜æˆ `/__ui/api/api/config`

**è§£å†³æ–¹æ¡ˆï¼š** æ‰€æœ‰ API è·¯å¾„ç›´æ¥ä½¿ç”¨ `/config` ç­‰ç›¸å¯¹è·¯å¾„

#### é—®é¢˜ 3: UI è¯·æ±‚è¢«è®¡å…¥ç»Ÿè®¡ âœ…

**åŸå› ï¼š** UI è¯·æ±‚å’Œæµè§ˆå™¨è‡ªåŠ¨è¯·æ±‚åœ¨ `finally` å—æ‰§è¡Œå‰æœªè¢«è¿‡æ»¤

**è§£å†³æ–¹æ¡ˆï¼š** (`packages/core/src/worker.ts:162-181`)

```typescript
// åœ¨ try å—ä¹‹å‰å¤„ç†ä¸éœ€è¦ç»Ÿè®¡çš„è¯·æ±‚
const uiResponse = await handleUIRequest(req);
if (uiResponse) return uiResponse;

// å¥åº·æ£€æŸ¥
if (url.pathname === '/health') return ...;

// æµè§ˆå™¨è‡ªåŠ¨è¯·æ±‚
if (url.pathname === '/favicon.ico' ||
    url.pathname === '/.well-known/appspecific/com.chrome.devtools.json') {
  return new Response(null, { status: 404 });
}
```

---

## Phase 2: ç›‘æ§å’Œå›¾è¡¨ âœ… å·²å®Œæˆ

### ç›®æ ‡

å¢å¼ºç›‘æ§èƒ½åŠ›ï¼Œæä¾›å¯è§†åŒ–çš„æ€§èƒ½æ•°æ®ã€‚

### å·²å®ŒæˆåŠŸèƒ½

#### 1. å®æ—¶ç›‘æ§é¢æ¿ âœ…

- [x] å›¾è¡¨åº“é›†æˆ (Chart.js 4.5.0 + svelte-chartjs 3.1.5)
- [x] QPS è¶‹åŠ¿å›¾ - æ˜¾ç¤ºæ¯æ—¶æ®µè¯·æ±‚æ•°
- [x] å“åº”æ—¶é—´è¶‹åŠ¿å›¾ - æ˜¾ç¤ºå¹³å‡å“åº”æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
- [x] é”™è¯¯ç‡ç›‘æ§ - æ˜¾ç¤ºé”™è¯¯ç™¾åˆ†æ¯”è¶‹åŠ¿
- [x] é”™è¯¯æ•°è¶‹åŠ¿å›¾ - æ˜¾ç¤ºç´¯ç§¯é”™è¯¯æ•°

#### 2. å›¾è¡¨ç»„ä»¶ âœ…

- [x] `LineChart.svelte` - é€šç”¨æŠ˜çº¿å›¾ç»„ä»¶
  - æ”¯æŒå¤šæ•°æ®é›†
  - è‡ªå®šä¹‰é¢œè‰²å’Œæ ·å¼
  - å“åº”å¼è®¾è®¡
  - å·¥å…·æç¤ºå’Œå›¾ä¾‹
- [x] `MonitoringCharts.svelte` - ç›‘æ§é¢æ¿ç»„ä»¶
  - 4 ä¸ªç›‘æ§å›¾è¡¨
  - è‡ªåŠ¨åˆ·æ–°ï¼ˆ10ç§’é—´éš”ï¼‰
  - æ—¶é—´èŒƒå›´é€‰æ‹©å™¨ï¼ˆ10ç§’/1åˆ†é’Ÿ/5åˆ†é’Ÿï¼‰
  - 2åˆ—ç½‘æ ¼å¸ƒå±€

#### 3. å†å²æ•°æ®æŸ¥è¯¢ âœ…

- [x] æ—¶é—´èŒƒå›´é€‰æ‹©å™¨ - æ”¯æŒ 10s/1m/5m ä¸‰ç§é‡‡æ ·é—´éš”
- [x] æ•°æ®è‡ªåŠ¨åˆ·æ–° - æ¯ 10 ç§’æ›´æ–°ä¸€æ¬¡

#### 4. Dashboard é›†æˆ âœ…

- [x] é›†æˆåˆ° Dashboard é¡µé¢
- [x] ç»Ÿè®¡å¡ç‰‡ + è¶‹åŠ¿å›¾è¡¨çš„å®Œæ•´å±•ç¤º
- [x] åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†

### æŠ€æœ¯å®ç°

**æ–°å¢æ–‡ä»¶ï¼š**
- `packages/ui/src/lib/components/LineChart.svelte` - é€šç”¨æŠ˜çº¿å›¾ç»„ä»¶
- `packages/ui/src/lib/components/MonitoringCharts.svelte` - ç›‘æ§é¢æ¿ç»„ä»¶
- `packages/ui/src/lib/types.ts` - ç±»å‹å®šä¹‰æ–‡ä»¶

**ä¾èµ–ï¼š**
- `chart.js@4.5.0` - å›¾è¡¨æ ¸å¿ƒåº“
- `svelte-chartjs@3.1.5` - Svelte å°è£…

---

## Phase 3: é«˜çº§é…ç½® âœ… å·²å®Œæˆ

### ç›®æ ‡

æ”¯æŒæ›´å¤æ‚çš„é…ç½®åŠŸèƒ½ã€‚

### å·²å®ŒæˆåŠŸèƒ½

#### 1. å…¨å±€é…ç½®ç¼–è¾‘ âœ…

- [x] æœåŠ¡å™¨åŸºç¡€é…ç½®ï¼ˆç«¯å£ã€workers æ•°é‡ç­‰ï¼‰
- [x] æ—¥å¿—çº§åˆ«é…ç½®
- [x] æ€§èƒ½è°ƒä¼˜å‚æ•°
- [x] åŒæ¨¡å¼ç¼–è¾‘å™¨ï¼ˆè¡¨å•/JSONï¼‰
- [x] å¯¼å…¥/å¯¼å‡ºé…ç½®æ–‡ä»¶

#### 2. è¡¨è¾¾å¼å¼•æ“ âœ…

- [x] å¯è§†åŒ–è¡¨è¾¾å¼ç¼–è¾‘å™¨ç»„ä»¶ (`ExpressionEditor.svelte`)
- [x] è¡¨è¾¾å¼æµ‹è¯•å·¥å…·
- [x] 8ä¸ªå¸¸ç”¨è¡¨è¾¾å¼æ¨¡æ¿åº“
- âš ï¸ **æ³¨æ„**ï¼šç»„ä»¶å·²åˆ›å»ºä½†æš‚æœªé›†æˆï¼Œç­‰å¾…åç«¯æ”¯æŒæ¡ä»¶è·¯ç”±åŠŸèƒ½

#### 3. Transformer é…ç½® âœ…

- [x] Transformer ç¼–è¾‘å™¨ç»„ä»¶ (`TransformerEditor.svelte`)
- [x] API æ ¼å¼è½¬æ¢é¢„è§ˆï¼ˆAnthropic â†” Gemini/OpenAIï¼‰
- [x] é›†æˆåˆ° RouteEditorï¼ˆè·¯ç”±çº§ï¼‰å’Œ UpstreamFormï¼ˆupstreamçº§ï¼‰
- [x] 5ç§è½¬æ¢å™¨æ”¯æŒ

#### 4. æ‰¹é‡æ“ä½œ âš ï¸

- [x] æ‰¹é‡å¯¼å…¥è·¯ç”±ï¼ˆJSONæ ¼å¼ï¼‰
- [x] æ‰¹é‡å¯¼å‡ºæ‰€æœ‰è·¯ç”±
- [x] è·¯ç”±æ¨¡æ¿åŠŸèƒ½ï¼ˆ7ä¸ªé¢„é…ç½®æ¨¡æ¿ï¼‰
- [ ] **æ‰¹é‡ä¿®æ”¹é…ç½®** - å¾…å®ç°

### æŠ€æœ¯å®ç°

**æ–°å¢ç»„ä»¶ï¼š**
- `ExpressionEditor.svelte` - è¡¨è¾¾å¼å¯è§†åŒ–ç¼–è¾‘å™¨ï¼ˆæš‚æœªé›†æˆï¼‰
- `TransformerEditor.svelte` - Transformeré…ç½®å’Œé¢„è§ˆ
- `RouteTemplates.svelte` - è·¯ç”±æ¨¡æ¿é€‰æ‹©å™¨

**ä¿®æ”¹æ–‡ä»¶ï¼š**
- `Configuration.svelte` - å®Œæ•´é‡å†™ï¼ŒåŒæ¨¡å¼ç¼–è¾‘å™¨
- `RouteEditor.svelte` - æ·»åŠ è·¯ç”±çº§Transformeré…ç½®å’Œæ¨¡æ¿é›†æˆ
- `UpstreamForm.svelte` - é›†æˆTransformerEditoræ›¿æ¢ç®€å•ä¸‹æ‹‰æ¡†
- `RoutesIndex.svelte` - æ·»åŠ å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½

---

## Phase 4: ç›‘æ§é«˜çº§åŠŸèƒ½ â³ å¾…å®ç°

### ç›®æ ‡

å¢å¼ºç›‘æ§èƒ½åŠ›ï¼Œæä¾›æ›´ç»†ç²’åº¦çš„æ€§èƒ½åˆ†æã€‚

### è®¡åˆ’åŠŸèƒ½

#### 1. è·¯ç”±çº§ç›‘æ§

- [ ] å•ä¸ªè·¯ç”±çš„æ€§èƒ½æŒ‡æ ‡
- [ ] Upstream å¥åº·çŠ¶æ€å¯è§†åŒ–
- [ ] è¯·æ±‚åˆ†å¸ƒçƒ­åŠ›å›¾
- [ ] å“åº”æ—¶é—´åˆ†å¸ƒç›´æ–¹å›¾

#### 2. å†å²æ•°æ®æŸ¥è¯¢

- [ ] æ—¶é—´èŒƒå›´é€‰æ‹©å™¨ï¼ˆæ‰©å±•æ›´å¤šé€‰é¡¹ï¼‰
- [ ] æ•°æ®å¯¼å‡ºåŠŸèƒ½ (CSV/JSON)
- [ ] è‡ªå®šä¹‰æŒ‡æ ‡èšåˆ

---

## Phase 5: ç³»ç»Ÿç®¡ç† ğŸš§ è¿›è¡Œä¸­

### ç›®æ ‡

æä¾›å®Œæ•´çš„ç³»ç»Ÿç®¡ç†èƒ½åŠ›ã€‚

### å·²å®ŒæˆåŠŸèƒ½

#### ç³»ç»Ÿæ“ä½œ âœ…

- [x] çƒ­é‡è½½é…ç½® (`routes/Configuration.svelte`)
  - ä¸€é”®çƒ­é‡è½½æŒ‰é’®
  - åŠ è½½çŠ¶æ€æŒ‡ç¤º
  - Toast æˆåŠŸ/å¤±è´¥é€šçŸ¥
  - è‡ªåŠ¨åˆ·æ–°é…ç½®æ˜¾ç¤º

### è®¡åˆ’åŠŸèƒ½

#### 1. é…ç½®ç‰ˆæœ¬ç®¡ç†

- [ ] é…ç½®å†å²è®°å½•
- [ ] ç‰ˆæœ¬å¯¹æ¯”ï¼ˆdiffï¼‰
- [ ] å›æ»šåŠŸèƒ½
- [ ] é…ç½®å¤‡ä»½/æ¢å¤

#### 2. å®‰å…¨ä¸æƒé™

- [ ] ç”¨æˆ·è®¤è¯ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] æ“ä½œå®¡è®¡æ—¥å¿—
- [ ] æ•æ„Ÿä¿¡æ¯è„±æ•

#### 3. ç³»ç»Ÿæ“ä½œï¼ˆç»§ç»­ï¼‰

- [ ] æœåŠ¡çŠ¶æ€ç›‘æ§
- [ ] Worker ç®¡ç†
- [ ] ä¼˜é›…é‡å¯

#### 4. å‘Šè­¦ä¸é€šçŸ¥

- [ ] æ€§èƒ½é˜ˆå€¼å‘Šè­¦
- [ ] Upstream æ•…éšœé€šçŸ¥
- [ ] è‡ªå®šä¹‰å‘Šè­¦è§„åˆ™
- [ ] Webhook é›†æˆ

---

## å½“å‰è¿›åº¦æ€»ç»“

### âœ… å·²å®Œæˆ

- **Phase 1** - æ ¸å¿ƒé…ç½®ç¼–è¾‘ï¼ˆæ‰€æœ‰åŠŸèƒ½ï¼‰
  - åŸºç¡€æ¶æ„æ­å»º
  - æ ¸å¿ƒ CRUD åŠŸèƒ½
  - è¡¨å•éªŒè¯
  - å®æ—¶ç»Ÿè®¡å±•ç¤º
  - æŠ€æœ¯éš¾ç‚¹æ”»å…‹ï¼ˆonMountã€APIè·¯å¾„ã€ç»Ÿè®¡è¿‡æ»¤ï¼‰

- **Phase 2** - ç›‘æ§å’Œå›¾è¡¨ï¼ˆæ‰€æœ‰åŠŸèƒ½ï¼‰
  - Chart.js é›†æˆ
  - 4 ä¸ªè¶‹åŠ¿å›¾è¡¨ï¼ˆQPSã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡ã€é”™è¯¯æ•°ï¼‰
  - æ—¶é—´èŒƒå›´é€‰æ‹©å™¨
  - è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
  - Dashboard é›†æˆ

- **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼ˆOption Bï¼‰
  - ConfirmDialog ç¡®è®¤å¯¹è¯æ¡†ç»„ä»¶
  - Toast é€šçŸ¥ç³»ç»Ÿï¼ˆ4ç§ç±»å‹ï¼‰
  - æŒ‰é’®åŠ è½½çŠ¶æ€æŒ‡ç¤ºå™¨
  - æ“ä½œé”™è¯¯å¤„ç†æ”¹è¿›

- **Phase 4** - ç³»ç»Ÿç®¡ç†ï¼ˆéƒ¨åˆ†å®Œæˆï¼‰
  - çƒ­é‡è½½é…ç½®åŠŸèƒ½

- **Phase 3** - é«˜çº§é…ç½®ï¼ˆåŸºæœ¬å®Œæˆï¼‰
  - å…¨å±€é…ç½®ç¼–è¾‘ï¼ˆåŒæ¨¡å¼ + å¯¼å…¥/å¯¼å‡ºï¼‰
  - Transformer é…ç½®ä¸é¢„è§ˆï¼ˆå·²é›†æˆï¼‰
  - è·¯ç”±æ¨¡æ¿ç³»ç»Ÿï¼ˆ7ä¸ªæ¨¡æ¿ï¼‰
  - æ‰¹é‡å¯¼å…¥/å¯¼å‡ºè·¯ç”±
  - ExpressionEditor ç»„ä»¶ï¼ˆå·²åˆ›å»ºï¼Œå¾…åç«¯æ”¯æŒï¼‰

### ğŸš§ è¿›è¡Œä¸­

- Phase 5: ç³»ç»Ÿç®¡ç†ï¼ˆçƒ­é‡è½½åŠŸèƒ½å·²å®Œæˆï¼Œå…¶ä»–åŠŸèƒ½å¾…å¼€å‘ï¼‰

### â³ å¾…å¼€å§‹

- Phase 4: ç›‘æ§é«˜çº§åŠŸèƒ½ï¼ˆè·¯ç”±çº§ç›‘æ§ã€å¥åº·çŠ¶æ€å¯è§†åŒ–ï¼‰
- Phase 3: æ‰¹é‡ä¿®æ”¹é…ç½®åŠŸèƒ½

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ä¼˜å…ˆçº§ P0ï¼ˆç«‹å³æ‰§è¡Œï¼‰

æ— ï¼ˆPhase 1 å’Œ Phase 2 å·²å®Œæˆï¼‰

### ä¼˜å…ˆçº§ P1ï¼ˆçŸ­æœŸè§„åˆ’ï¼‰

1. **Phase 3 - æ‰¹é‡ä¿®æ”¹é…ç½®**
   - æ‰¹é‡æ›´æ–°å¤šä¸ªè·¯ç”±çš„é…ç½®
   - æ‰¹é‡ä¿®æ”¹ Transformer
   - æ‰¹é‡ä¿®æ”¹ Headers/Body

2. **Phase 4 - ç›‘æ§é«˜çº§åŠŸèƒ½**
   - å•ä¸ªè·¯ç”±çš„æ€§èƒ½æŒ‡æ ‡
   - Upstream å¥åº·çŠ¶æ€å¯è§†åŒ–
   - è¯·æ±‚åˆ†å¸ƒçƒ­åŠ›å›¾
   - å†å²æ•°æ®å¯¼å‡º

3. **Phase 5 - ç³»ç»Ÿç®¡ç†ï¼ˆç»§ç»­ï¼‰**
   - é…ç½®ç‰ˆæœ¬ç®¡ç†
   - æ“ä½œæ—¥å¿—è®°å½•
   - Worker ç®¡ç†ç•Œé¢
   - æœåŠ¡çŠ¶æ€ç›‘æ§

### ä¼˜å…ˆçº§ P2ï¼ˆä¸­æœŸè§„åˆ’ï¼‰

1. **æ€§èƒ½ä¸ä½“éªŒä¼˜åŒ–**
   - å“åº”å¼è®¾è®¡å®Œå–„ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰
   - é”®ç›˜å¿«æ·é”®
   - æš—è‰²ä¸»é¢˜
   - å›½é™…åŒ–æ”¯æŒï¼ˆi18nï¼‰

2. **å‘Šè­¦ä¸é€šçŸ¥ç³»ç»Ÿ**
   - æ€§èƒ½é˜ˆå€¼å‘Šè­¦
   - Upstream æ•…éšœé€šçŸ¥
   - è‡ªå®šä¹‰å‘Šè­¦è§„åˆ™
   - Webhook é›†æˆ

---

## æŠ€æœ¯å€ºåŠ¡ä¸æ”¹è¿›ç‚¹

### ä»£ç è´¨é‡

- [ ] è¡¥å……å•å…ƒæµ‹è¯•
- [ ] è¡¥å……é›†æˆæµ‹è¯•
- [ ] ä»£ç æ³¨é‡Šå®Œå–„

### ç”¨æˆ·ä½“éªŒ

- [ ] å“åº”å¼è®¾è®¡ä¼˜åŒ–ï¼ˆç§»åŠ¨ç«¯é€‚é…ï¼‰
- [ ] é”®ç›˜å¿«æ·é”®æ”¯æŒ
- [ ] å›½é™…åŒ–æ”¯æŒï¼ˆi18nï¼‰
- [ ] æš—è‰²ä¸»é¢˜æ”¯æŒ

### æ€§èƒ½ä¼˜åŒ–

- [ ] è™šæ‹Ÿæ»šåŠ¨ï¼ˆé•¿åˆ—è¡¨ä¼˜åŒ–ï¼‰
- [ ] è¯·æ±‚é˜²æŠ–/èŠ‚æµ
- [ ] æ•°æ®ç¼“å­˜ç­–ç•¥

### å¯è®¿é—®æ€§

- [ ] ä¿®å¤è¡¨å• label å…³è”è­¦å‘Š
- [ ] ARIA å±æ€§å®Œå–„
- [ ] é”®ç›˜å¯¼èˆªæ”¯æŒ

---

## å…³é”®æ–‡ä»¶ç´¢å¼•

### å‰ç«¯æ ¸å¿ƒæ–‡ä»¶

```
packages/ui/src/
â”œâ”€â”€ App.svelte                    # ä¸»åº”ç”¨å…¥å£
â”œâ”€â”€ main.ts                       # åº”ç”¨å¯åŠ¨
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ stores/                   # çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ config.ts            # é…ç½® store
â”‚   â”‚   â”œâ”€â”€ stats.ts             # ç»Ÿè®¡ store
â”‚   â”‚   â””â”€â”€ toast.ts             # Toast é€šçŸ¥ store (UX ä¼˜åŒ–)
â”‚   â”œâ”€â”€ api/                      # API å±‚
â”‚   â”‚   â”œâ”€â”€ client.ts            # HTTP å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ routes.ts            # è·¯ç”± API
â”‚   â”‚   â”œâ”€â”€ config.ts            # é…ç½® API
â”‚   â”‚   â”œâ”€â”€ stats.ts             # ç»Ÿè®¡ API
â”‚   â”‚   â””â”€â”€ system.ts            # ç³»ç»Ÿ API
â”‚   â”œâ”€â”€ validation/               # éªŒè¯é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ route-validator.ts
â”‚   â”‚   â””â”€â”€ upstream-validator.ts
â”‚   â”œâ”€â”€ components/               # ç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ HeadersEditor.svelte
â”‚   â”‚   â”œâ”€â”€ BodyEditor.svelte
â”‚   â”‚   â”œâ”€â”€ UpstreamForm.svelte
â”‚   â”‚   â”œâ”€â”€ RouteCard.svelte
â”‚   â”‚   â”œâ”€â”€ LineChart.svelte     # é€šç”¨æŠ˜çº¿å›¾ (Phase 2)
â”‚   â”‚   â”œâ”€â”€ MonitoringCharts.svelte # ç›‘æ§é¢æ¿ (Phase 2)
â”‚   â”‚   â”œâ”€â”€ ConfirmDialog.svelte # ç¡®è®¤å¯¹è¯æ¡† (UX ä¼˜åŒ–)
â”‚   â”‚   â”œâ”€â”€ Toast.svelte         # Toast é€šçŸ¥ (UX ä¼˜åŒ–)
â”‚   â”‚   â”œâ”€â”€ ToastContainer.svelte # Toast å®¹å™¨ (UX ä¼˜åŒ–)
â”‚   â”‚   â”œâ”€â”€ ExpressionEditor.svelte # è¡¨è¾¾å¼ç¼–è¾‘å™¨ (Phase 3, å¾…é›†æˆ)
â”‚   â”‚   â”œâ”€â”€ TransformerEditor.svelte # Transformeré…ç½® (Phase 3)
â”‚   â”‚   â””â”€â”€ RouteTemplates.svelte # è·¯ç”±æ¨¡æ¿ (Phase 3)
â”‚   â””â”€â”€ types.ts                  # ç±»å‹å®šä¹‰
â””â”€â”€ routes/                       # é¡µé¢
    â”œâ”€â”€ Dashboard.svelte
    â”œâ”€â”€ RoutesIndex.svelte
    â”œâ”€â”€ RouteEditor.svelte
    â”œâ”€â”€ Configuration.svelte     # åŒ…å«çƒ­é‡è½½åŠŸèƒ½ (Phase 4)
    â””â”€â”€ NotFound.svelte
```

### åç«¯æ ¸å¿ƒæ–‡ä»¶

```
packages/core/src/
â”œâ”€â”€ worker.ts                     # è¯·æ±‚å¤„ç†æ ¸å¿ƒï¼ˆç»Ÿè®¡è¿‡æ»¤é€»è¾‘ï¼‰
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ server.ts                # UI è¯·æ±‚å¤„ç†
â”‚   â””â”€â”€ assets.ts                # é™æ€èµ„æº
â””â”€â”€ api/
    â”œâ”€â”€ router.ts                # API è·¯ç”±
    â”œâ”€â”€ handlers/                # API å¤„ç†å™¨
    â”‚   â”œâ”€â”€ config.ts
    â”‚   â”œâ”€â”€ stats.ts
    â”‚   â””â”€â”€ system.ts
    â””â”€â”€ collectors/
        â””â”€â”€ stats-collector.ts   # ç»Ÿè®¡æ”¶é›†å™¨
```

### é…ç½®æ–‡ä»¶

- `packages/ui/vite.config.ts` - Vite é…ç½®ï¼ˆåŒ…å« onMount ä¿®å¤ï¼‰
- `packages/ui/svelte.config.js` - Svelte é…ç½®
- `packages/ui/tailwind.config.js` - Tailwind é…ç½®
- `packages/ui/tsconfig.json` - TypeScript é…ç½®

---

## å¤‡æ³¨

### å¼€å‘ç¯å¢ƒå¯åŠ¨

```bash
# UI å¼€å‘æ¨¡å¼
cd packages/ui && bun run dev

# åç«¯å¼€å‘æ¨¡å¼
bun --watch packages/core/src/main.ts

# å®Œæ•´æ„å»º
bun run build
```

### é‡è¦æé†’

1. **onMount é—®é¢˜**ï¼šå¿…é¡»ä¿æŒ vite.config.ts ä¸­çš„ `resolve.conditions` é…ç½®
2. **API è·¯å¾„**ï¼šæ‰€æœ‰ API è°ƒç”¨ä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œä¸è¦åŠ  `/api` å‰ç¼€
3. **ç»Ÿè®¡è¿‡æ»¤**ï¼šä¸ç»Ÿè®¡ UI è¯·æ±‚éœ€è¦åœ¨ try å—ä¹‹å‰è¿”å›
4. **è·¯ç”±æ–¹å¼**ï¼šä½¿ç”¨æ‰‹åŠ¨æ¡ä»¶æ¸²æŸ“ï¼Œä¸ä½¿ç”¨ svelte-spa-router çš„ Router ç»„ä»¶

---

*æ–‡æ¡£æ›´æ–°æ—¶é—´: 2025-10-03*
